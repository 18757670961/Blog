---
title: Linux Fundaments
author: Desmond
catalog: true
tags: Linux
abbrlink: e8006866
date: 2020-09-12 15:04:41
header-img: e8006866/head.jpg
categories:
top:
---



# Linux Fundaments



## Online References

- [Bootlin](https://elixir.bootlin.com/) - source code
- [Linux Tools](https://linuxtools-rst.readthedocs.io/)



## The UNIX/Linux Philosophy

- **Keep programs small**：write a program to do one well-defined task; do it efficiently, do it well
- **Avoid verbosity**：perform no unessential output from any programs; use short names for commands and command options
- **Make programs modular**：build small, independent, and self-sufficient program parts, with each serving a specific function. These program parts can be flexibly combined to form larger programs. This principle is reflected in the small kernel (core of the operating system) cooperating with a large set of small commands which work well together
- **Compose programs through interfaces**：write programs that are easy to interface with other programs. The famous UNIX pipe, which interfaces the output of a program to the input of another, is a primary example of this philosophy.



## Linux Organization

![](https://6772-grp2020-4glv8fo5cd87cf9a-1302562267.tcb.qcloud.la/linux-fundaments/1.jpg?sign=adfbb47630d7f765950a2170ebc9b563&t=1622128282)



## File System (ext4)

A data table (**index**) creates apparent connections between individual files and groups of files with identifiable locations on a disk, providing the appearance of an organized set of directories and files within a single disk division (**partition**)

The way directories are arranged is largely governed by the UNIX Filesystem Hierarchy Standard (FHS)

Every object within a Linux file system is represented by a unique collection of metadata called an **inode**, which identifies the disk location and attributes of files.

When you move, copy, or delete a file or directory, all you're really doing is editing its inode attributes, not its ID

![](https://6772-grp2020-4glv8fo5cd87cf9a-1302562267.tcb.qcloud.la/linux-fundaments/3.jpg?sign=c142aeb5f8c4ff5621f21bed3ffbb5e5&t=1622128336)

Standard folders under home directory:

- **Desktop**: Files in this folder appear as icons on graphical desktop display, including regular files and application launchers (with filename suffix .desktop)
- **Documents**: Textual documents such as PDF files and those created using tools such as Apache OpenOffice and LibreOffice.
- **Download**: Files downloaded from the network
- **Music**: Sound and music files
- **Pictures**: Pictures from digital cameras
- **public_html**: Files under this folder are made available to the Web via an HTTP server on Linux system
- **Videos**: Files from video cameras and recorders

Names of Linux file:

- **absolute/full pathname**: start from root (/)

  e.g. /home/pwang/note.txt

- **relative pathname**: relative to current working directory

  e.g. pwang/note.txt

- **simple name**

  e.g. note.txt

### Pseudo File System

Pseudo file's contents (e.g. those exist in /sys/ and /proc/) are dynamically generated by OS itself to represent specific values.

Linux organizes attached storage as **block devices**

![](https://6772-grp2020-4glv8fo5cd87cf9a-1302562267.tcb.qcloud.la/linux-fundaments/7.jpg?sign=860af735521757e5cab9297d250f5148&t=1622128376)

sda (storage device A) is the first drive used by system on boot

![](https://6772-grp2020-4glv8fo5cd87cf9a-1302562267.tcb.qcloud.la/linux-fundaments/8.jpg?sign=6ff17a82966aea8c8b7011b94ff731b5&t=1622128386)

Each of sda1, sda2, sda5 represents one of partitions created by Linux



## Shell and Commands

The standard Shell for Linux is the Bash (Bourne-Again Sh), which is a powerful and much improved version of Sh. The default Shell on most Linux distributions is Bash.

![](https://6772-grp2020-4glv8fo5cd87cf9a-1302562267.tcb.qcloud.la/linux-fundaments/4.jpg?sign=22ec715a8d63f7b0a9bd34b7306c8748&t=1622128346)

At the Shell prompt, enter the following command to display the name of the Shell you are using：

```bash
echo $0
# examine the value of a Shell variable
```

```bash
echo $HOME
# display the location of home directory
```

You can change the default Shell with the **chsh** (change Shell) command.

![](https://6772-grp2020-4glv8fo5cd87cf9a-1302562267.tcb.qcloud.la/linux-fundaments/2.jpg?sign=59afcce4b29a2088ee9a0fa8d0eeafe2&t=1622128321)

### Command syntax

General form for a command：

**command-name** [options] ... [arguments] ...

```bash
ls folder
```
lists the names of files in a folder (directory) specified by the argument folder. If a directory is not given, ls lists the current working directory

```bash
ls -a
```

The ls command will not list hidden files, any file whose name begins with the period (.) character, unless the -a option is given

```bash
ls -F folder
```
adds the -F (file type) option to ls telling it to display the name of each file, or each filename, with an extra character at the end to indicate its file type: / for a folder, * for an executable ...

- **single-letter option**

  ```bash
  ls -l
  # long listing option
  ```

  ```bash
  ls -lh
  # the h argument displays file sizes in a human-readable format (K, M, G)
  ```

  ```bash
  ls -R
  # the R argument displays subdirectories and the files and subdirectories they contain
  ```

- **full-word option (human-readable)**

  ```bash
  ls --help
  # --help option provides brief and concise usage information
  ```
  

**Multiple commands** can be typed on the same line if they are separated by a semicolon ;

```bash
echo -n "Hello Linux "; echo user
```

The option -n causes echo to omit a NEWLINE character at the end of its output, so the word user appears on the same line as Hello Linux.

```bash
hostname
# find out your Linux system's hostname

uname --all
who
# identify the operating system version

more .bash_profile
# display contents of the file .bash_profile in user's home directory

date
# display the current date and time

passwd
# change password

man command 
# display the documentation for the given command (regular command)
# press / to get a text entry field at the bottom of the screen where you can type search pattern. If the first highlighted result isn't what you want, press n to search forward

info
# similar to man but no need of command name

help builtin_command
# display a summary of any particular Bash built-in command

pwd (print working directory)
# display the absolute pathname of your current working directory

cd directory (change working directory)
# change working directory to the specified directory

cd /
# back to root directory

cd 
# go to home directory

cd ~userid
# go to home directory of userid

cat filename
# print file contents to output

less filename
# display file contents which can be scrolled up and down. press q to exit
```

**Tip：to abort a command, type interrupt character (CTRL+C)**

2 **irregular files (pointers)** are kept in every directory:

- File **.** is a pointer to the directory in which current file resides

- File **..** is a pointer to the parent directory of the directory in which current file resides

  ```bash
  cd ..
  # move up one level in the directory hierarchy
  ```

### Handling Files and Directories

In Linux, end of line is indicated by NEWLINE

In Windows/DOS, end of line is indicated by RETURN followed by NEWLINE

```bash
cp source destination
```

The file source is copied to a file/directory named destination. If the destination file doesn't exist, it will be created; if it already exists, its contents will be overwritten

```bash
mv filename newdir
```

permanently move a file from one directory to a new directory

**File Globbing**: describe applying wildcard characters to the filenames addressed by commands

```bash
mv * directoryname
# move all contents of current directory

mv file* directoryname
# move only files that begins with "file"

mv file? directoryname
# apply to only names contain "file" and one other character
```

```bash
rm filename1 filename2 ...
rmdir directoryname1 directoryname2 ...
```

The argument of rm is a list of one or more filenames to be removed. rmdir takes as its argument a list of one or more directory names. **rmdir only will delete an empty directory. Generally, to remove a directory, you must first clean it out using rm.**

```bash
rm -r directoryname
```

add -r (recursive) flag to delete everything beneath the directory

**Tip**: the command line has no trash can !!!

```bash
mkdir name
```

mkdir takes as its argument the name of the directory to be created.

```bash
touch filename
```

touch quickly creates an empty file

**Tip**: touching an existing file with touch updates its time stamp without making any changes

![](https://6772-grp2020-4glv8fo5cd87cf9a-1302562267.tcb.qcloud.la/linux-fundaments/6.jpg?sign=a85175eff0517974c03bba11d76e5b88&t=1622128368)

use stat command to display more information about the file created by touch, including inode information

### Protecting Files: Access Control

#### **Protection Bits** 

9-bit code to control access to each file, specify access permission to a file for 3 classes of users. 

First 3 bits -> u, next 3 bits -> g, final 3 bits -> o

- **u** - super user (the owner/creator of the file, no restriction)
- **g** - members in the file's group
- **o** - others

3 access permissions for a file:

- **r** - read permission, first bit
- **w** - write permission, second bit
- **x** - execute permission, third bit

**Root**: a class of super users to whom no file access restrictions apply. The root status is gained by logging in under the userid root / through the **su** command.

#### **Protection Mode**

9 protection bits can be represented by a 3-digit octal number

```bash
-rw-rw-rw- 1 smith 127 Jan 20 1:24 primer
```

![](https://6772-grp2020-4glv8fo5cd87cf9a-1302562267.tcb.qcloud.la/linux-fundaments/5.jpg?sign=8b6fb1f51963fde0c2555064a0e1bc52&t=1622128357)

#### Setting Permissions

A user needs the x permission to enter a directory, the r permission to list filenames in the directory, and the w permission to create/delete files in the directory

Usually, a file is created with the default protection **-rw-------**, so only the file owner can read/write the file.

To change the protection mode on a file:

```bash
chmod mode filename
```

mode can appear in 2 formats:

- an octal number to set all 9 bits specifically (e.g. 644 for rw-r--r--) 

- specify modifications to the file's existing permissions:

  **who op permission op2 permission2 ...**

  who - user class (**a** for all 3 u, g, o)

  op - change to be made (+ to add permission, - to take away permission, = to reset permission)

  permission - any combination of r, w, x

```bash
chmod o-w filename
# deny write permission to others

chmod a+x filename
# make the file executable by all

chmod u-w+x filename
# take away write and grant execute permission for the owner

chmod a=rw filename
# give read and write permission for all classes of user
```

#### Compile and Run Program

compile the program:

```bash
gcc -o mytry try.c
# -o rename the executable file to mytry
```

To run a program is simply the pathname of the executable file:

```bash
./mytry
```

**Output Redirection**:

```bash
  ./mytry > results
  # > redirect output of mytry from the terminal screen into a new file named results
```

```bash
  script record_file
  # record terminal session into a record_file (typescript by default)
  # The recording continues until CTRL+D is typed
```

  e.g.

  ```bash
  script display_record
  cc myprogram.c
  a.out
  CTRL+D
  # all I/O following script will be recorded in the file display_record
  ```

**Tip**: The file produced by script will contain both input to and output from the program. The file created by redirecting output will contain only output

### Getting Error Information

```bash
journalctl
# access all system logs
```

use filter:
![](https://6772-grp2020-4glv8fo5cd87cf9a-1302562267.tcb.qcloud.la/linux-fundaments/9.jpg?sign=6253debef79c22e400e508f2406044b3&t=1622128394)

print to the screen only those lines that include the string filename.php

```bash
journalctl | grep filename.php | grep error
# further narrow down

journalctl | grep filename.php | grep -v error
# -v for not including
```

### Other Tricks

pressing the **Tab** key tells Bash to display its best guess on the command line

![](https://6772-grp2020-4glv8fo5cd87cf9a-1302562267.tcb.qcloud.la/linux-fundaments/10.jpg?sign=517c5c6f208097fde7bdcbdcdd567c70&t=1622128302)

![](https://6772-grp2020-4glv8fo5cd87cf9a-1302562267.tcb.qcloud.la/linux-fundaments/11.png?sign=51dcaa306103e5b13947ed72f1653d49&t=1622128311)





------

> References:
>
> 《Mastering Modern Linux》(2nd edition) —— Paul S. Wang
>
> 《Linux in Action》 —— David Clinton